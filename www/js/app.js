var app=angular.module("app",["ionic","utilitiesModule","directives","wu.masonry","betModule"]).run(function(){Parse.initialize(CONFIG.appId,CONFIG.masterKey),Parse.serverURL=CONFIG.serverURL}).config(["$stateProvider","$urlRouterProvider","$ionicConfigProvider","$locationProvider",function(t,e,i,n){i.scrolling.jsScrolling(!0),i.navBar.alignTitle("center"),t.state("bet",{url:"/",templateUrl:"app/bet/bet-list.html",controller:"BetListCtrl"}),n.html5Mode(!0),e.otherwise(function(t,e){var i=t.get("$state");i.go("bet")})}]);angular.module("directives",[]).directive("ngEnter",function(){"use strict";return function(t,e,i){e.bind("keydown keypress",function(e){13===e.which&&(t.$apply(function(){t.$eval(i.ngEnter)}),e.preventDefault())})}}).directive("whenScrolled",function(){return function(t,e,i){var n=e[0];e.bind("scroll",function(){n.scrollTop+n.offsetHeight>=n.scrollHeight&&t.$apply(i.whenScrolled)})}}).directive("isFocused",["$timeout",function(t){return{scope:{trigger:"&isFocused"},link:function(e,i){e.trigger()&&t(function(){i[0].focus(),i[0].click()})}}}]).directive("targetBlank",function(){return{compile:function(t){var e="A"===t.prop("tagName")?t:t.find("a");e.attr("target","_blank")}}}).directive("isVisible",function(){"use strict";return function(t,e,i){if(!e[0].hidden){var n=e[0].id;n||(n=e[0].classList[0]),t.$emit("visible",n)}}}).directive("lowerCase",function(){return{require:"ngModel",link:function(t,e,i,n){n.$parsers.push(function(t){var e=t.toLowerCase().replace(/ /g,"");return e!=t&&(n.$setViewValue(e),n.$render()),e})}}}),angular.module("utilitiesModule",[]).factory("UtilitiesFactory",["$q","$rootScope","$ionicModal","$ionicLoading","$ionicActionSheet","$ionicPopup","$ionicSideMenuDelegate","$ionicScrollDelegate","$ionicPopover",function(t,e,i,n,o,r,l,c,u){var s=[],a={},f=null;return{showToast:function(t,e){e=0==e?null:e||1500,n.show({template:t,duration:e,showBackdrop:!1})},hideToast:function(){n.hide()},showModal:function(t,e){i.fromTemplateUrl(t,{scope:e,animation:"slide-in-up",focusFirstInput:!1,showBackdrop:!1}).then(function(t){s.push(t),t.show()})},hideModal:function(){var t=s.pop();t&&(t.hide(),t.remove())},showPopover:function(t,e,i){u.fromTemplateUrl(t,{scope:e}).then(function(t){f=t,f.show(i)})},hidePopover:function(){f&&f.hide()},showActions:function(t,e,i,n){var r=this;a=o.show({buttons:[{text:"Edit"}],destructiveText:"Delete",titleText:t,cancelText:"Cancel",buttonClicked:function(t){return!0},destructiveButtonClicked:function(){return r.showDeleteConfirm("Delete service "+t,e),!0}})},closeActions:function(){a()},getObjectSize:function(t){var e,i=0;for(var e in element)element.hasOwnProperty(e)&&i++;return i},closeSideMenu:function(){l.toggleLeft(!1)},resizeWindow:function(){c.resize()},showPopUp:function(e,i){var n=t.defer(),o=r.confirm({title:e,template:i});return o.then(function(t){t?n.resolve(t):n.reject()}),n.promise},showPrompt:function(i,n){var o=t.defer(),l=e.$new(!0);l.data={};var c=r.show({title:i,subTitle:n,template:'<input type="number" ng-model="data.input">',scope:l,buttons:[{text:"Cancel"},{text:"<b>Set</b>",type:"button-positive",onTap:function(t){return l.data.input?l.data.input:0==l.data.input?-1:void t.preventDefault()}}]});return c.then(function(t){t?o.resolve(t):o.reject()}),o.promise},scrollTop:function(){c.scrollTop()},scrollBottom:function(){c.scrollBottom()},flattenParseObj:function(t){function e(t){for(var e in t)t[e]=i(t[e]);return t}function i(t){if(t&&null!=t.attributes){var i=e(t.attributes),i={id:t.id};return angular.extend(i,t.attributes),i}return t}return i(t)}}}]);var homeDir="./app/bet/";angular.module("betModule",[]).controller("BetListCtrl",["$scope","BetFactory","UtilitiesFactory","$timeout",function(t,e,i,n){t.options={limit:1e3,difficulty:0},t.bets=[],i.showToast("Loading..."),e.getBets(t.options).then(function(e){t.bets=e,t.filteredBets=e,i.hideToast()},function(t){i.hideToast()}),t.filter=function(e){t.options.difficulty=e,t.filteredBets=[];var i=angular.copy(t.bets);if(e>0)for(var n=0;n<i.length;n++)i[n].difficulty==e&&t.filteredBets.push(i[n]);else t.filteredBets=i},t.bet=function(){i.showToast("3..."),n(function(){i.showToast("2...")},1e3),n(function(){i.showToast("1...")},2e3),n(function(){i.hideToast(),i.showModal("./app/bet/bet-detail.html",t)},3e3)},t.showBetAddModal=function(){i.showModal("./app/bet/bet-add-modal.html",t)},t.hideModal=function(){i.hideModal()}}]).controller("BetAddCtrl",["$scope","BetFactory","UtilitiesFactory",function(t,e,i){t.bet={difficulty:1,description:""},t.addBet=function(){i.showToast("Adding bet..."),e.addBet(t.bet).then(function(e){t.bets.unshift(e),t.options.difficulty==t.bet.difficulty&&t.filteredBets.unshift(e),i.hideModal(),i.showToast("Bet added!",1500)})}}]).controller("BetDetailCtrl",["$scope","UtilitiesFactory",function(t,e){var i=~~(Math.random()*t.filteredBets.length);t.bet=t.filteredBets[i],t.completeBet=function(){e.hideModal(),t.filteredBets.splice(i,1),t.filteredBets.length<=0&&(t.filter(t.options.difficulty),e.showToast("Resetting...",2e3))}}]).factory("BetFactory",["$q","UtilitiesFactory",function(t,e){return{getBets:function(i){var n=t.defer(),o=new Parse.Query("Bet");return o.limit(i.limit),o.skip(i.page*i.limit),i.difficulty&&i.difficulty>-1&&o.equalTo("difficulty",i.difficulty),o.find().then(function(t){t&&t.length>0?n.resolve(t.map(function(t){return e.flattenParseObj(t)})):n.reject()}),n.promise},addBet:function(i){var n=t.defer(),o=new Parse.Object("Bet");return o.set("description",i.description),o.set("difficulty",parseInt(i.difficulty)),o.save().then(function(t){n.resolve(e.flattenParseObj(t))}),n.promise}}}]);